<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>黄金挖矿游戏</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #8B4513 0%, #D2691E 50%, #F4A460 100%);
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }

        .game-container {
            width: 800px;
            height: 600px;
            background: linear-gradient(to bottom, #87CEEB 0%, #87CEEB 40%, #8B4513 40%, #654321 100%);
            border: 3px solid #8B4513;
            border-radius: 20px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .game-header {
            position: absolute;
            top: 10px;
            left: 10px;
            right: 10px;
            height: 60px;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            color: white;
            z-index: 100;
        }

        .score {
            font-size: 18px;
            font-weight: bold;
        }

        .time {
            font-size: 18px;
            font-weight: bold;
        }

        .level {
            font-size: 18px;
            font-weight: bold;
        }

        .game-area {
            position: absolute;
            top: 80px;
            left: 10px;
            right: 10px;
            bottom: 70px;
            background: rgba(139, 69, 19, 0.3);
            border-radius: 10px;
            overflow: hidden;
        }

        .miner {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 80px;
            background: #FFE4B5;
            border: 2px solid #8B4513;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .miner:hover {
            transform: translateX(-50%) scale(1.1);
        }

        .miner.mining {
            animation: mining 0.5s infinite alternate;
        }

        @keyframes mining {
            0% { transform: translateX(-50%) translateY(0); }
            100% { transform: translateX(-50%) translateY(-10px); }
        }

        .gold {
            position: absolute;
            width: 30px;
            height: 30px;
            background: radial-gradient(circle, #FFD700 0%, #FFA500 100%);
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(255, 215, 0, 0.5);
        }

        .gold:hover {
            transform: scale(1.2);
        }

        .gold.collected {
            animation: collect 0.5s ease-out forwards;
        }

        @keyframes collect {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0); opacity: 0; }
        }

        .rock {
            position: absolute;
            background: #696969;
            border-radius: 20%;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .rock:hover {
            transform: scale(1.1);
        }

        .rock.broken {
            animation: break 0.5s ease-out forwards;
        }

        @keyframes break {
            0% { transform: scale(1) rotate(0deg); opacity: 1; }
            100% { transform: scale(0.5) rotate(180deg); opacity: 0; }
        }

        .controls {
            position: absolute;
            bottom: 10px;
            left: 10px;
            right: 10px;
            height: 50px;
            background: rgba(0,0,0,0.7);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .btn {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .btn:hover {
            background: #45a049;
            transform: scale(1.05);
        }

        .btn:active {
            transform: scale(0.95);
        }

        .btn.danger {
            background: #f44336;
        }

        .btn.danger:hover {
            background: #da190b;
        }

        .game-over {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.8);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
        }

        .game-over-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .game-over h2 {
            color: #8B4513;
            margin-bottom: 20px;
            font-size: 32px;
        }

        .game-over p {
            color: #333;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .power-up {
            position: absolute;
            width: 25px;
            height: 25px;
            background: radial-gradient(circle, #FF69B4 0%, #FF1493 100%);
            border-radius: 50%;
            cursor: pointer;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .explosion {
            position: absolute;
            width: 50px;
            height: 50px;
            background: radial-gradient(circle, #FF6347 0%, #FF4500 100%);
            border-radius: 50%;
            animation: explode 0.5s ease-out forwards;
        }

        @keyframes explode {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(2); opacity: 0; }
        }

        .combo-text {
            position: absolute;
            color: #FFD700;
            font-size: 24px;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            animation: comboFade 1s ease-out forwards;
        }

        @keyframes comboFade {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="game-header">
            <div class="score">金币: <span id="score">0</span></div>
            <div class="level">关卡: <span id="level">1</span></div>
            <div class="time">时间: <span id="time">60</span>秒</div>
        </div>

        <div class="game-area" id="gameArea">
            <div class="miner" id="miner">⛏️</div>
        </div>

        <div class="controls">
            <button class="btn" id="startBtn">开始游戏</button>
            <button class="btn danger" id="pauseBtn" style="display: none;">暂停</button>
            <button class="btn" id="resetBtn">重新开始</button>
        </div>

        <div class="game-over" id="gameOver">
            <div class="game-over-content">
                <h2>游戏结束!</h2>
                <p>最终得分: <span id="finalScore">0</span></p>
                <p>达到关卡: <span id="finalLevel">1</span></p>
                <button class="btn" onclick="resetGame()">再玩一次</button>
            </div>
        </div>
    </div>

    <script>
        class GoldMiningGame {
            constructor() {
                this.score = 0;
                this.level = 1;
                this.timeLeft = 60;
                this.isGameRunning = false;
                this.isPaused = false;
                this.miner = document.getElementById('miner');
                this.gameArea = document.getElementById('gameArea');
                this.scoreElement = document.getElementById('score');
                this.levelElement = document.getElementById('level');
                this.timeElement = document.getElementById('time');
                this.gameOverElement = document.getElementById('gameOver');
                this.startBtn = document.getElementById('startBtn');
                this.pauseBtn = document.getElementById('pauseBtn');
                this.resetBtn = document.getElementById('resetBtn');

                this.gameTimer = null;
                this.spawnTimer = null;
                this.combo = 0;
                this.lastCollectionTime = 0;

                this.initEventListeners();
            }

            initEventListeners() {
                this.startBtn.addEventListener('click', () => this.startGame());
                this.pauseBtn.addEventListener('click', () => this.togglePause());
                this.resetBtn.addEventListener('click', () => this.resetGame());

                this.miner.addEventListener('click', () => this.minerAction());

                document.addEventListener('keydown', (e) => {
                    if (e.code === 'Space') {
                        e.preventDefault();
                        this.minerAction();
                    }
                });
            }

            startGame() {
                this.isGameRunning = true;
                this.isPaused = false;
                this.startBtn.style.display = 'none';
                this.pauseBtn.style.display = 'inline-block';
                this.gameOverElement.style.display = 'none';

                this.gameTimer = setInterval(() => this.updateGame(), 1000);
                this.spawnTimer = setInterval(() => this.spawnItems(), 2000 - (this.level * 100));

                this.spawnItems();
            }

            togglePause() {
                this.isPaused = !this.isPaused;
                this.pauseBtn.textContent = this.isPaused ? '继续' : '暂停';

                if (this.isPaused) {
                    clearInterval(this.gameTimer);
                    clearInterval(this.spawnTimer);
                } else {
                    this.gameTimer = setInterval(() => this.updateGame(), 1000);
                    this.spawnTimer = setInterval(() => this.spawnItems(), 2000 - (this.level * 100));
                }
            }

            updateGame() {
                if (this.isPaused) return;

                this.timeLeft--;
                this.timeElement.textContent = this.timeLeft;

                if (this.timeLeft <= 0) {
                    this.endGame();
                }

                if (this.score >= this.level * 100) {
                    this.levelUp();
                }

                this.updateCombo();
            }

            minerAction() {
                if (!this.isGameRunning || this.isPaused) return;

                this.miner.classList.add('mining');

                setTimeout(() => {
                    this.miner.classList.remove('mining');
                }, 500);

                this.collectNearbyItems();
            }

            collectNearbyItems() {
                const minerRect = this.miner.getBoundingClientRect();
                const gameAreaRect = this.gameArea.getBoundingClientRect();

                const items = this.gameArea.querySelectorAll('.gold, .rock, .power-up');
                let collected = false;

                items.forEach(item => {
                    const itemRect = item.getBoundingClientRect();
                    const distance = Math.sqrt(
                        Math.pow(minerRect.left - itemRect.left, 2) +
                        Math.pow(minerRect.top - itemRect.top, 2)
                    );

                    if (distance < 100) {
                        if (item.classList.contains('gold')) {
                            this.collectGold(item);
                            collected = true;
                        } else if (item.classList.contains('rock')) {
                            this.breakRock(item);
                            collected = true;
                        } else if (item.classList.contains('power-up')) {
                            this.collectPowerUp(item);
                            collected = true;
                        }
                    }
                });

                if (collected) {
                    this.combo++;
                    this.lastCollectionTime = Date.now();
                }
            }

            collectGold(gold) {
                const value = Math.floor(Math.random() * 20) + 10;
                this.score += value;
                this.updateScore();

                gold.classList.add('collected');
                this.showComboText(gold, `+${value}`);

                setTimeout(() => {
                    if (gold.parentNode) {
                        gold.parentNode.removeChild(gold);
                    }
                }, 500);
            }

            breakRock(rock) {
                const penalty = Math.floor(Math.random() * 10) + 5;
                this.score = Math.max(0, this.score - penalty);
                this.updateScore();

                rock.classList.add('broken');
                this.createExplosion(rock);

                setTimeout(() => {
                    if (rock.parentNode) {
                        rock.parentNode.removeChild(rock);
                    }
                }, 500);
            }

            collectPowerUp(powerUp) {
                const bonus = Math.floor(Math.random() * 50) + 25;
                this.score += bonus;
                this.timeLeft += 10;
                this.updateScore();
                this.timeElement.textContent = this.timeLeft;

                powerUp.classList.add('collected');
                this.showComboText(powerUp, `+${bonus} +10秒`);

                setTimeout(() => {
                    if (powerUp.parentNode) {
                        powerUp.parentNode.removeChild(powerUp);
                    }
                }, 500);
            }

            createExplosion(element) {
                const explosion = document.createElement('div');
                explosion.className = 'explosion';
                explosion.style.left = element.style.left;
                explosion.style.top = element.style.top;
                this.gameArea.appendChild(explosion);

                setTimeout(() => {
                    if (explosion.parentNode) {
                        explosion.parentNode.removeChild(explosion);
                    }
                }, 500);
            }

            showComboText(element, text) {
                const comboText = document.createElement('div');
                comboText.className = 'combo-text';
                comboText.textContent = text;
                comboText.style.left = element.style.left;
                comboText.style.top = element.style.top;
                this.gameArea.appendChild(comboText);

                setTimeout(() => {
                    if (comboText.parentNode) {
                        comboText.parentNode.removeChild(comboText);
                    }
                }, 1000);
            }

            updateCombo() {
                const now = Date.now();
                if (now - this.lastCollectionTime > 3000) {
                    this.combo = 0;
                }
            }

            spawnItems() {
                if (!this.isGameRunning || this.isPaused) return;

                const itemCount = Math.floor(Math.random() * 3) + 1;

                for (let i = 0; i < itemCount; i++) {
                    setTimeout(() => {
                        const itemType = Math.random();
                        let item;

                        if (itemType < 0.6) {
                            item = this.createGold();
                        } else if (itemType < 0.9) {
                            item = this.createRock();
                        } else {
                            item = this.createPowerUp();
                        }

                        this.gameArea.appendChild(item);

                        setTimeout(() => {
                            if (item.parentNode) {
                                item.parentNode.removeChild(item);
                            }
                        }, 8000);
                    }, i * 500);
                }
            }

            createGold() {
                const gold = document.createElement('div');
                gold.className = 'gold';
                gold.style.left = Math.random() * (this.gameArea.offsetWidth - 30) + 'px';
                gold.style.top = Math.random() * (this.gameArea.offsetHeight - 30) + 'px';
                return gold;
            }

            createRock() {
                const rock = document.createElement('div');
                rock.className = 'rock';
                const size = Math.random() * 30 + 20;
                rock.style.width = size + 'px';
                rock.style.height = size + 'px';
                rock.style.left = Math.random() * (this.gameArea.offsetWidth - size) + 'px';
                rock.style.top = Math.random() * (this.gameArea.offsetHeight - size) + 'px';
                return rock;
            }

            createPowerUp() {
                const powerUp = document.createElement('div');
                powerUp.className = 'power-up';
                powerUp.style.left = Math.random() * (this.gameArea.offsetWidth - 25) + 'px';
                powerUp.style.top = Math.random() * (this.gameArea.offsetHeight - 25) + 'px';
                return powerUp;
            }

            levelUp() {
                this.level++;
                this.levelElement.textContent = this.level;
                this.timeLeft += 30;

                const levelUpText = document.createElement('div');
                levelUpText.className = 'combo-text';
                levelUpText.textContent = `升级到关卡 ${this.level}!`;
                levelUpText.style.left = '50%';
                levelUpText.style.top = '50%';
                levelUpText.style.transform = 'translate(-50%, -50%)';
                levelUpText.style.fontSize = '32px';
                this.gameArea.appendChild(levelUpText);

                setTimeout(() => {
                    if (levelUpText.parentNode) {
                        levelUp.parentNode.removeChild(levelUpText);
                    }
                }, 2000);

                clearInterval(this.spawnTimer);
                this.spawnTimer = setInterval(() => this.spawnItems(), Math.max(500, 2000 - (this.level * 100)));
            }

            updateScore() {
                this.scoreElement.textContent = this.score;
            }

            endGame() {
                this.isGameRunning = false;
                clearInterval(this.gameTimer);
                clearInterval(this.spawnTimer);

                document.getElementById('finalScore').textContent = this.score;
                document.getElementById('finalLevel').textContent = this.level;
                this.gameOverElement.style.display = 'flex';

                this.startBtn.style.display = 'inline-block';
                this.pauseBtn.style.display = 'none';
            }

            resetGame() {
                this.isGameRunning = false;
                this.isPaused = false;
                this.score = 0;
                this.level = 1;
                this.timeLeft = 60;
                this.combo = 0;

                clearInterval(this.gameTimer);
                clearInterval(this.spawnTimer);

                this.updateScore();
                this.levelElement.textContent = this.level;
                this.timeElement.textContent = this.timeLeft;

                this.gameArea.innerHTML = '<div class="miner" id="miner">⛏️</div>';
                this.miner = document.getElementById('miner');
                this.miner.addEventListener('click', () => this.minerAction());

                this.gameOverElement.style.display = 'none';
                this.startBtn.style.display = 'inline-block';
                this.pauseBtn.style.display = 'none';
                this.pauseBtn.textContent = '暂停';
            }
        }

        let game;

        window.onload = function() {
            game = new GoldMiningGame();
        };

        function resetGame() {
            game.resetGame();
        }
    </script>
</body>
</html>